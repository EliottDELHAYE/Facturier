(()=>{"use strict";function t(t,e,i){const n=i.value;return{configurable:!0,enumerable:!1,get(){return n.bind(this)}}}class e{constructor(t,e,i,n,s,r,d,o,a,c,l,h){this.documentType=t,this.firstName=e,this.lastName=i,this.address=n,this.country=s,this.town=r,this.zip=d,this.product=o,this.price=a,this.quantity=c,this.tva=l,this.date=h}subTotal(t,e,i){return(t+t*(i/100))*e}htmlFormat(){const t=this.subTotal(this.price,this.quantity,this.tva);return`\n        <div id="document-container">\n          <div class="document-header">\n            <div>\n              <img class="logo-ed" src="./medias/Logo ED SVG.svg">\n            </div>\n            <div>\n              <p>${"invoice"===this.documentType?"Facture":"Devis"}<span> N° ${Math.floor(101*Math.random())}</span></p>\n              <p>Date <span>${this.date.toLocaleDateString()}</span></p>\n            </div>\n          </div>\n        \n          <div class="document-informations">\n            <div>\n              <p>ED</p>\n              <p>22 rue des Champs-Élysées</p>\n              <p>75008 Paris</p>\n              <p>Tel: +33 6 36 37 89 27</p>\n            </div>\n            <div>\n              <p>Informations du client</p>\n              <p>${this.lastName} ${this.firstName}</p>\n              <p>${this.address} </p>\n              <p>${this.zip}</p>\n              <p>${this.town}</p>\n              <p>${this.country}</p>\n            </div>\n          </div>\n        \n          <div class="document-product">\n            <div>\n              <table>\n                <thead>\n                  <tr>\n                    <th>Produit/Service</th>\n                    <th>Prix unitaire</th>\n                    <th>Quantité</th>\n                    <th>Total HT</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td>${this.product}</td>\n                    <td>${this.price} €</td>\n                    <td>${this.quantity}</td>\n                    <td>${this.price*this.quantity} € HT</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n          <div class="document-total">\n            <div>\n              <div>TOTAL TTC</div>\n              <div>${t.toFixed(2)} €</div>\n            </div>\n          </div>\n        </div>\n\n    `}}class i{constructor(t,e){this.oldData=[],this.setItem(t,e)}static checkLocalStorage(){null===localStorage.getItem("invoice")&&localStorage.setItem("invoice","[]"),null===localStorage.getItem("estimate")&&localStorage.setItem("estimate","[]")}setItem(t,e){let i;i=localStorage.getItem(t),null!==i?(this.oldData=JSON.parse(i),this.oldData.push(e),localStorage.setItem(t,JSON.stringify(this.oldData))):document.location.reload()}}class n{constructor(t,e,i){this.container=t,this.hiddenDiv=e,this.btnPrint=i,this.formContainer=document.getElementById("form-container")}render(t,e){const n=t.htmlFormat();this.container.innerHTML=n,new i(e,n),this.btnPrint.innerText="invoice"===e?"Imprimer la facture":"Imprimer le devis",this.hiddenDiv.setAttribute("style","visibility: visible;"),this.formContainer.innerHTML=""}}class s{constructor(t){this.el=t}print(){document.body.innerHTML=this.el.innerHTML,window.print(),document.location.reload()}}var r=function(t,e,i,n){var s,r=arguments.length,d=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(d=(r<3?s(d):r>3?s(e,i,d):s(e,i))||d);return r>3&&d&&Object.defineProperty(e,i,d),d};class d{constructor(){this.form=document.getElementById("form"),this.type=document.getElementById("type"),this.firstName=document.getElementById("firstName"),this.lastName=document.getElementById("lastName"),this.address=document.getElementById("address"),this.country=document.getElementById("country"),this.town=document.getElementById("town"),this.zip=document.getElementById("zip"),this.product=document.getElementById("product"),this.price=document.getElementById("price"),this.quantity=document.getElementById("quantity"),this.tva=document.getElementById("tva"),this.docContainer=document.getElementById("aspect-ratio-container"),this.hiddenDiv=document.getElementById("hiddenDiv"),this.storedDataDiv=document.getElementById("stored-data"),this.btnPrint=document.getElementById("print"),this.btnReload=document.getElementById("reload"),this.btnStoredInvoices=document.getElementById("stored-invoices"),this.btnStoredEstimates=document.getElementById("stored-estimates"),this.submitFormListener(),this.printListener(),this.reloadListener(),this.getStoredDocsListener()}submitFormListener(){this.form.addEventListener("submit",this.handleFormSubmit)}printListener(){this.btnPrint.addEventListener("click",(()=>{let t;t=new s(this.docContainer),t.print()}))}reloadListener(){this.btnReload.addEventListener("click",(()=>{document.location.reload(),window.scrollTo(0,0)}))}getStoredDocsListener(){this.btnStoredInvoices.addEventListener("click",(()=>this.getItems("invoice"))),this.btnStoredEstimates.addEventListener("click",(()=>this.getItems("estimate")))}getItems(t){if(this.storedDataDiv.hasChildNodes()&&(this.storedDataDiv.innerHTML=""),localStorage.getItem(t)){let e;if(e=localStorage.getItem(t),null!==e&&e.length>2){let t;t=JSON.parse(e),t.map((t=>{let e=document.createElement("div"),i=document.createElement("div");e.classList.add("card-classes"),i.classList.add("card-body"),i.innerHTML=t,e.append(i),this.storedDataDiv.append(e)}))}else this.storedDataDiv.innerHTML=`<div>Aucun${"invoice"===t?"e facture":" devis"} disponible !</div>`}}handleFormSubmit(t){t.preventDefault(),this.hideListDocuments();const i=this.inputDatas();if(Array.isArray(i)){const[t,s,r,d,o,a,c,l,h,m,u]=i;let v,p,y=new Date;v=new e(...i,y),p=new n(this.docContainer,this.hiddenDiv,this.btnPrint),p.render(v,t)}}hideListDocuments(){this.btnStoredInvoices.setAttribute("style","visibility: hidden"),this.btnStoredEstimates.setAttribute("style","visibility: hidden"),this.storedDataDiv.setAttribute("style","visibility: hidden")}inputDatas(){const t=this.type.value,e=this.firstName.value,i=this.lastName.value,n=this.address.value,s=this.country.value,r=this.town.value,d=this.zip.valueAsNumber,o=this.product.value,a=this.price.valueAsNumber,c=this.quantity.valueAsNumber,l=this.tva.valueAsNumber;return d>0&&a>0&&c>0&&l>0?[t,e,i,n,s,r,d,o,a,c,l]:void alert("Les valeurs numériques doivent être supérieur à zéro !")}}r([t],d.prototype,"submitFormListener",null),r([t],d.prototype,"handleFormSubmit",null),new d,i.checkLocalStorage()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJtQkFDTyxTQUFTQSxFQUFLQyxFQUFhQyxFQUFvQkMsR0FDcEQsTUFBTUMsRUFBaUJELEVBQVdFLE1BUWxDLE1BUHdDLENBQ3RDQyxjQUFjLEVBQ2RDLFlBQVksRUFDWixHQUFBQyxHQUNFLE9BQU9KLEVBQWVKLEtBQUtTLEtBQzdCLEVBR0osQ0NUTyxNQUFNQyxFQUNYLFdBQUFDLENBQ1VDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBWEEsS0FBQVgsYUFBQUEsRUFDQSxLQUFBQyxVQUFBQSxFQUNBLEtBQUFDLFNBQUFBLEVBQ0EsS0FBQUMsUUFBQUEsRUFDQSxLQUFBQyxRQUFBQSxFQUNBLEtBQUFDLEtBQUFBLEVBQ0EsS0FBQUMsSUFBQUEsRUFDQSxLQUFBQyxRQUFBQSxFQUNBLEtBQUFDLE1BQUFBLEVBQ0EsS0FBQUMsU0FBQUEsRUFDQSxLQUFBQyxJQUFBQSxFQUNBLEtBQUFDLEtBQUFBLENBQ1AsQ0FFSyxRQUFBQyxDQUFTSixFQUFlQyxFQUFrQkMsR0FHaEQsT0FBUUYsRUFEU0EsR0FERUUsRUFBTSxNQUVHRCxDQUM5QixDQUVBLFVBQUFJLEdBQ0UsTUFBTUMsRUFBYWpCLEtBQUtlLFNBQVNmLEtBQUtXLE1BQU9YLEtBQUtZLFNBQVVaLEtBQUthLEtBQ2pFLE1BQU8sb09BUTJCLFlBQXRCYixLQUFLRyxhQUE2QixVQUFZLG9CQUNuQ2UsS0FBS0MsTUFBc0IsSUFBaEJELEtBQUtFLHFEQUNicEIsS0FBS2MsS0FBS08sbVpBYXJCckIsS0FBS0ssWUFBWUwsS0FBS0ksbUNBQ3RCSixLQUFLTSxrQ0FDTE4sS0FBS1MsNkJBQ0xULEtBQUtRLDhCQUNMUixLQUFLTyx5ZUFpQkVQLEtBQUtVLHlDQUNMVixLQUFLVyx5Q0FDTFgsS0FBS1ksMENBQ0xaLEtBQUtXLE1BQVFYLEtBQUtZLDBQQVN2QkssRUFBV0ssUUFBUSwwRUFNdEMsRUN0RkssTUFBTUMsRUFHWCxXQUFBckIsQ0FBWXNCLEVBQW1CQyxHQUYvQixLQUFBQyxRQUFvQixHQUdsQjFCLEtBQUsyQixRQUFRSCxFQUFXQyxFQUMxQixDQUNBLHdCQUFPRyxHQUNtQyxPQUFwQ0MsYUFBYUMsUUFBUSxZQUN2QkQsYUFBYUYsUUFBUSxVQUFXLE1BRU8sT0FBckNFLGFBQWFDLFFBQVEsYUFDdkJELGFBQWFGLFFBQVEsV0FBWSxLQUVyQyxDQUVBLE9BQUFBLENBQVFILEVBQW1CQyxHQUN6QixJQUFJTSxFQUNKQSxFQUFRRixhQUFhQyxRQUFRTixHQUNmLE9BQVZPLEdBQ0YvQixLQUFLMEIsUUFBVU0sS0FBS0MsTUFBTUYsR0FDMUIvQixLQUFLMEIsUUFBUVEsS0FBS1QsR0FDbEJJLGFBQWFGLFFBQVFILEVBQVdRLEtBQUtHLFVBQVVuQyxLQUFLMEIsV0FFcERVLFNBQVNDLFNBQVNDLFFBRXRCLEVDdkJLLE1BQU1DLEVBR1gsV0FBQXJDLENBQ1VzQyxFQUNBQyxFQUNBQyxHQUZBLEtBQUFGLFVBQUFBLEVBQ0EsS0FBQUMsVUFBQUEsRUFDQSxLQUFBQyxTQUFBQSxFQUVSMUMsS0FBSzJDLGNBQWdCUCxTQUFTUSxlQUM1QixpQkFFSixDQUNBLE1BQUFDLENBQU9DLEVBQXVCQyxHQUM1QixNQUFNdEIsRUFBcUJxQixFQUFPOUIsYUFDbENoQixLQUFLd0MsVUFBVVEsVUFBWXZCLEVBRTNCLElBQUlGLEVBQVF3QixFQUFTdEIsR0FHbkJ6QixLQUFLMEMsU0FBU08sVUFEQSxZQUFaRixFQUN3QixzQkFFQSxvQkFFNUIvQyxLQUFLeUMsVUFBVVMsYUFBYSxRQUFTLHdCQUNyQ2xELEtBQUsyQyxjQUFjSyxVQUFZLEVBQ2pDLEVDM0JLLE1BQU1HLEVBQ1gsV0FBQWpELENBQW9Ca0QsR0FBQSxLQUFBQSxHQUFBQSxDQUFxQixDQUN6QyxLQUFBQyxHQUNFakIsU0FBU2tCLEtBQUtOLFVBQVloRCxLQUFLb0QsR0FBR0osVUFDbENPLE9BQU9GLFFBQ1BqQixTQUFTQyxTQUFTQyxRQUNwQixFLDBVQ0FLLE1BQU1rQixFQXVCWCxXQUFBdEQsR0FDRUYsS0FBS3lELEtBQU9yQixTQUFTUSxlQUFlLFFBQ3BDNUMsS0FBSzBELEtBQU90QixTQUFTUSxlQUFlLFFBQ3BDNUMsS0FBS0ksVUFBWWdDLFNBQVNRLGVBQWUsYUFDekM1QyxLQUFLSyxTQUFXK0IsU0FBU1EsZUFBZSxZQUN4QzVDLEtBQUtNLFFBQVU4QixTQUFTUSxlQUFlLFdBQ3ZDNUMsS0FBS08sUUFBVTZCLFNBQVNRLGVBQWUsV0FDdkM1QyxLQUFLUSxLQUFPNEIsU0FBU1EsZUFBZSxRQUNwQzVDLEtBQUtTLElBQU0yQixTQUFTUSxlQUFlLE9BQ25DNUMsS0FBS1UsUUFBVTBCLFNBQVNRLGVBQWUsV0FDdkM1QyxLQUFLVyxNQUFReUIsU0FBU1EsZUFBZSxTQUNyQzVDLEtBQUtZLFNBQVd3QixTQUFTUSxlQUFlLFlBQ3hDNUMsS0FBS2EsSUFBTXVCLFNBQVNRLGVBQWUsT0FFbkM1QyxLQUFLMkQsYUFBZXZCLFNBQVNRLGVBQzNCLDBCQUVGNUMsS0FBS3lDLFVBQVlMLFNBQVNRLGVBQWUsYUFDekM1QyxLQUFLNEQsY0FBZ0J4QixTQUFTUSxlQUM1QixlQUdGNUMsS0FBSzBDLFNBQVdOLFNBQVNRLGVBQWUsU0FDeEM1QyxLQUFLNkQsVUFBWXpCLFNBQVNRLGVBQWUsVUFDekM1QyxLQUFLOEQsa0JBQW9CMUIsU0FBU1EsZUFDaEMsbUJBRUY1QyxLQUFLK0QsbUJBQXFCM0IsU0FBU1EsZUFDakMsb0JBSUY1QyxLQUFLZ0UscUJBQ0xoRSxLQUFLaUUsZ0JBQ0xqRSxLQUFLa0UsaUJBQ0xsRSxLQUFLbUUsdUJBQ1AsQ0FJUSxrQkFBQUgsR0FDTmhFLEtBQUt5RCxLQUFLVyxpQkFBaUIsU0FBVXBFLEtBQUtxRSxpQkFDNUMsQ0FDUSxhQUFBSixHQUNOakUsS0FBSzBDLFNBQVMwQixpQkFBaUIsU0FBUyxLQUN0QyxJQUFJRSxFQUNKQSxFQUFlLElBQUluQixFQUFNbkQsS0FBSzJELGNBQzlCVyxFQUFhakIsT0FBTyxHQUV4QixDQUNRLGNBQUFhLEdBQ05sRSxLQUFLNkQsVUFBVU8saUJBQWlCLFNBQVMsS0FDdkNoQyxTQUFTQyxTQUFTQyxTQUNsQmlCLE9BQU9nQixTQUFTLEVBQUcsRUFBRSxHQUV6QixDQUNRLHFCQUFBSixHQUdObkUsS0FBSzhELGtCQUFrQk0saUJBQWlCLFNBQVMsSUFDL0NwRSxLQUFLd0UsU0FBUyxhQUVoQnhFLEtBQUsrRCxtQkFBbUJLLGlCQUFpQixTQUFTLElBQ2hEcEUsS0FBS3dFLFNBQVMsYUFFbEIsQ0FHUSxRQUFBQSxDQUFTekIsR0FLZixHQUpJL0MsS0FBSzRELGNBQWNhLGtCQUNyQnpFLEtBQUs0RCxjQUFjWixVQUFZLElBRzdCbkIsYUFBYUMsUUFBUWlCLEdBQVUsQ0FDakMsSUFBSWhCLEVBR0osR0FGQUEsRUFBUUYsYUFBYUMsUUFBUWlCLEdBRWYsT0FBVmhCLEdBQWtCQSxFQUFNMkMsT0FBUyxFQUFHLENBQ3RDLElBQUlDLEVBQ0pBLEVBQVkzQyxLQUFLQyxNQUFNRixHQUN2QjRDLEVBQVVDLEtBQUtDLElBQ2IsSUFBSUMsRUFBdUIxQyxTQUFTMkMsY0FBYyxPQUM5Q0MsRUFBMkI1QyxTQUFTMkMsY0FBYyxPQUV0REQsRUFBS0csVUFBVUMsSUFBSSxnQkFDbkJGLEVBQVNDLFVBQVVDLElBRlcsYUFJOUJGLEVBQVNoQyxVQUFZNkIsRUFDckJDLEVBQUtLLE9BQU9ILEdBQ1poRixLQUFLNEQsY0FBY3VCLE9BQU9MLEVBQUssR0FFbkMsTUFDRTlFLEtBQUs0RCxjQUFjWixVQUFZLGFBQ2pCLFlBQVpELEVBQXdCLFlBQWMsNkJBRzVDLENBQ0YsQ0FJUSxnQkFBQXNCLENBQWlCZSxHQUN2QkEsRUFBRUMsaUJBRUZyRixLQUFLc0Ysb0JBRUwsTUFBTUMsRUFBU3ZGLEtBQUt3RixhQUVwQixHQUFJQyxNQUFNQyxRQUFRSCxHQUFTLENBQ3pCLE1BQ0U3QixFQUNBdEQsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FDRTBFLEVBRUosSUFBSUksRUFJQUMsRUFIQTlFLEVBQWEsSUFBSStFLEtBQ3JCRixFQUFVLElBQUkxRixLQUFTc0YsRUFBUXpFLEdBRy9COEUsRUFBVyxJQUFJckQsRUFBUXZDLEtBQUsyRCxhQUFjM0QsS0FBS3lDLFVBQVd6QyxLQUFLMEMsVUFDL0RrRCxFQUFTL0MsT0FBTzhDLEVBQVNqQyxFQUMzQixDQUNGLENBQ1EsaUJBQUE0QixHQUNOdEYsS0FBSzhELGtCQUFrQlosYUFBYSxRQUFTLHNCQUM3Q2xELEtBQUsrRCxtQkFBbUJiLGFBQWEsUUFBUyxzQkFDOUNsRCxLQUFLNEQsY0FBY1YsYUFBYSxRQUFTLHFCQUMzQyxDQUdRLFVBQUFzQyxHQWVOLE1BQU05QixFQUFPMUQsS0FBSzBELEtBQUs5RCxNQUNqQlEsRUFBWUosS0FBS0ksVUFBVVIsTUFDM0JTLEVBQVdMLEtBQUtLLFNBQVNULE1BQ3pCVSxFQUFVTixLQUFLTSxRQUFRVixNQUN2QlcsRUFBVVAsS0FBS08sUUFBUVgsTUFDdkJZLEVBQU9SLEtBQUtRLEtBQUtaLE1BQ2pCYSxFQUFNVCxLQUFLUyxJQUFJcUYsY0FDZnBGLEVBQVVWLEtBQUtVLFFBQVFkLE1BQ3ZCZSxFQUFRWCxLQUFLVyxNQUFNbUYsY0FDbkJsRixFQUFXWixLQUFLWSxTQUFTa0YsY0FDekJqRixFQUFNYixLQUFLYSxJQUFJaUYsY0FFckIsT0FBSXJGLEVBQU0sR0FBS0UsRUFBUSxHQUFLQyxFQUFXLEdBQUtDLEVBQU0sRUFDekMsQ0FDTDZDLEVBQ0F0RCxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxRQUdGa0YsTUFBTSx5REFHVixFQWhKUSxHQURQeEcsRyx1Q0E4RE8sR0FEUEEsRyxxQ0NoSUgsSUFBSWlFLEVBQ0pqQyxFQUFRSyxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL2ZhY3R1cmllci8uL3NyYy9kZWNvcmF0b3JzL0JpbmQudHMiLCJ3ZWJwYWNrOi8vZmFjdHVyaWVyLy4vc3JjL2NsYXNzZXMvRGF0YS50cyIsIndlYnBhY2s6Ly9mYWN0dXJpZXIvLi9zcmMvY2xhc3Nlcy9TdG9yYWdlLnRzIiwid2VicGFjazovL2ZhY3R1cmllci8uL3NyYy9jbGFzc2VzL0Rpc3BsYXkudHMiLCJ3ZWJwYWNrOi8vZmFjdHVyaWVyLy4vc3JjL2NsYXNzZXMvUHJpbnQudHMiLCJ3ZWJwYWNrOi8vZmFjdHVyaWVyLy4vc3JjL2NsYXNzZXMvRm9ybUlucHV0LnRzIiwid2VicGFjazovL2ZhY3R1cmllci8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMZSBkw6ljb3JhdGV1ciBiaW5kIHBlcm1ldCBkZSBsaWVyIGxhIG3DqXRob2RlIMOgIGwnaW5zdGFuY2UgZGUgbGEgY2xhc3NlXG5leHBvcnQgZnVuY3Rpb24gYmluZCh0YXJnZXQ6IGFueSwgbWV0aG9kTmFtZTogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpIHtcbiAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICBsZXQgbmV3RGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICBnZXQoKSB7XG4gICAgICByZXR1cm4gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcbiAgICB9LFxuICB9O1xuICByZXR1cm4gbmV3RGVzY3JpcHRvcjtcbn1cbiIsImltcG9ydCB7IEhhc0h0bWxGb3JtYXQgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNIdG1sRm9ybWF0XCI7XG5cbmV4cG9ydCBjbGFzcyBEYXRhcyBpbXBsZW1lbnRzIEhhc0h0bWxGb3JtYXQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGRvY3VtZW50VHlwZTogc3RyaW5nLFxuICAgIHByaXZhdGUgZmlyc3ROYW1lOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBsYXN0TmFtZTogc3RyaW5nLFxuICAgIHByaXZhdGUgYWRkcmVzczogc3RyaW5nLFxuICAgIHByaXZhdGUgY291bnRyeTogc3RyaW5nLFxuICAgIHByaXZhdGUgdG93bjogc3RyaW5nLFxuICAgIHByaXZhdGUgemlwOiBudW1iZXIsXG4gICAgcHJpdmF0ZSBwcm9kdWN0OiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBwcmljZTogbnVtYmVyLFxuICAgIHByaXZhdGUgcXVhbnRpdHk6IG51bWJlcixcbiAgICBwcml2YXRlIHR2YTogbnVtYmVyLFxuICAgIHByaXZhdGUgZGF0ZTogRGF0ZVxuICApIHt9XG5cbiAgcHJpdmF0ZSBzdWJUb3RhbChwcmljZTogbnVtYmVyLCBxdWFudGl0eTogbnVtYmVyLCB0dmE6IG51bWJlcik6IG51bWJlciB7XG4gICAgY29uc3QgdHZhUGVyY2VudCA9IHR2YSAvIDEwMDsgLy8gMjAlID0gMCwyXG4gICAgY29uc3QgdG90YWxUdmEgPSBwcmljZSAqIHR2YVBlcmNlbnQ7XG4gICAgcmV0dXJuIChwcmljZSArIHRvdGFsVHZhKSAqIHF1YW50aXR5O1xuICB9XG5cbiAgaHRtbEZvcm1hdCgpOiBzdHJpbmcge1xuICAgIGNvbnN0IHRvdGFsUHJpY2UgPSB0aGlzLnN1YlRvdGFsKHRoaXMucHJpY2UsIHRoaXMucXVhbnRpdHksIHRoaXMudHZhKTtcbiAgICByZXR1cm4gYFxuICAgICAgICA8ZGl2IGlkPVwiZG9jdW1lbnQtY29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImRvY3VtZW50LWhlYWRlclwiPlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgPGltZyBjbGFzcz1cImxvZ28tZWRcIiBzcmM9XCIuL21lZGlhcy9Mb2dvIEVEIFNWRy5zdmdcIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgPHA+JHtcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50VHlwZSA9PT0gXCJpbnZvaWNlXCIgPyBcIkZhY3R1cmVcIiA6IFwiRGV2aXNcIlxuICAgICAgICAgICAgICB9PHNwYW4+IE7CsCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMSl9PC9zcGFuPjwvcD5cbiAgICAgICAgICAgICAgPHA+RGF0ZSA8c3Bhbj4ke3RoaXMuZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX08L3NwYW4+PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJkb2N1bWVudC1pbmZvcm1hdGlvbnNcIj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxwPkVEPC9wPlxuICAgICAgICAgICAgICA8cD4yMiBydWUgZGVzIENoYW1wcy3DiWx5c8OpZXM8L3A+XG4gICAgICAgICAgICAgIDxwPjc1MDA4IFBhcmlzPC9wPlxuICAgICAgICAgICAgICA8cD5UZWw6ICszMyA2IDM2IDM3IDg5IDI3PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8cD5JbmZvcm1hdGlvbnMgZHUgY2xpZW50PC9wPlxuICAgICAgICAgICAgICA8cD4ke3RoaXMubGFzdE5hbWV9ICR7dGhpcy5maXJzdE5hbWV9PC9wPlxuICAgICAgICAgICAgICA8cD4ke3RoaXMuYWRkcmVzc30gPC9wPlxuICAgICAgICAgICAgICA8cD4ke3RoaXMuemlwfTwvcD5cbiAgICAgICAgICAgICAgPHA+JHt0aGlzLnRvd259PC9wPlxuICAgICAgICAgICAgICA8cD4ke3RoaXMuY291bnRyeX08L3A+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImRvY3VtZW50LXByb2R1Y3RcIj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDx0YWJsZT5cbiAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgIDx0aD5Qcm9kdWl0L1NlcnZpY2U8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8dGg+UHJpeCB1bml0YWlyZTwvdGg+XG4gICAgICAgICAgICAgICAgICAgIDx0aD5RdWFudGl0w6k8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8dGg+VG90YWwgSFQ8L3RoPlxuICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgPHRkPiR7dGhpcy5wcm9kdWN0fTwvdGQ+XG4gICAgICAgICAgICAgICAgICAgIDx0ZD4ke3RoaXMucHJpY2V9IOKCrDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgIDx0ZD4ke3RoaXMucXVhbnRpdHl9PC90ZD5cbiAgICAgICAgICAgICAgICAgICAgPHRkPiR7dGhpcy5wcmljZSAqIHRoaXMucXVhbnRpdHl9IOKCrCBIVDwvdGQ+XG4gICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZG9jdW1lbnQtdG90YWxcIj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxkaXY+VE9UQUwgVFRDPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXY+JHt0b3RhbFByaWNlLnRvRml4ZWQoMil9IOKCrDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgYDtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSGFzU2V0SXRlbSB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0hhc1NldEl0ZW1cIjtcblxuZXhwb3J0IGNsYXNzIFN0b3JhZ2UgaW1wbGVtZW50cyBIYXNTZXRJdGVtIHtcbiAgb2xkRGF0YTogc3RyaW5nW10gPSBbXTtcblxuICBjb25zdHJ1Y3Rvcih0eXBlVmFsdWU6IHN0cmluZywgaHRtbFN0cmluZzogc3RyaW5nKSB7XG4gICAgdGhpcy5zZXRJdGVtKHR5cGVWYWx1ZSwgaHRtbFN0cmluZyk7XG4gIH1cbiAgc3RhdGljIGNoZWNrTG9jYWxTdG9yYWdlKCk6IHZvaWQge1xuICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImludm9pY2VcIikgPT09IG51bGwpIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiaW52b2ljZVwiLCBcIltdXCIpO1xuICAgIH1cbiAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJlc3RpbWF0ZVwiKSA9PT0gbnVsbCkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJlc3RpbWF0ZVwiLCBcIltdXCIpO1xuICAgIH1cbiAgfVxuXG4gIHNldEl0ZW0odHlwZVZhbHVlOiBzdHJpbmcsIGh0bWxTdHJpbmc6IHN0cmluZyk6IHZvaWQge1xuICAgIGxldCBhcnJheTogc3RyaW5nIHwgbnVsbDtcbiAgICBhcnJheSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHR5cGVWYWx1ZSk7XG4gICAgaWYgKGFycmF5ICE9PSBudWxsKSB7XG4gICAgICB0aGlzLm9sZERhdGEgPSBKU09OLnBhcnNlKGFycmF5KTtcbiAgICAgIHRoaXMub2xkRGF0YS5wdXNoKGh0bWxTdHJpbmcpO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odHlwZVZhbHVlLCBKU09OLnN0cmluZ2lmeSh0aGlzLm9sZERhdGEpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZG9jdW1lbnQubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBIYXNSZW5kZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNSZW5kZXJcIjtcbmltcG9ydCB7IEhhc0h0bWxGb3JtYXQgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNIdG1sRm9ybWF0XCI7XG5pbXBvcnQgeyBTdG9yYWdlIH0gZnJvbSBcIi4vU3RvcmFnZVwiO1xuXG5leHBvcnQgY2xhc3MgRGlzcGxheSBpbXBsZW1lbnRzIEhhc1JlbmRlciB7XG4gIGZvcm1Db250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCxcbiAgICBwcml2YXRlIGhpZGRlbkRpdjogSFRNTERpdkVsZW1lbnQsXG4gICAgcHJpdmF0ZSBidG5QcmludDogSFRNTEJ1dHRvbkVsZW1lbnRcbiAgKSB7XG4gICAgdGhpcy5mb3JtQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgICBcImZvcm0tY29udGFpbmVyXCJcbiAgICApIGFzIEhUTUxEaXZFbGVtZW50O1xuICB9XG4gIHJlbmRlcihkb2NPYmo6IEhhc0h0bWxGb3JtYXQsIGRvY1R5cGU6IHN0cmluZykge1xuICAgIGNvbnN0IGh0bWxTdHJpbmc6IHN0cmluZyA9IGRvY09iai5odG1sRm9ybWF0KCk7XG4gICAgdGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gaHRtbFN0cmluZztcblxuICAgIG5ldyBTdG9yYWdlKGRvY1R5cGUsIGh0bWxTdHJpbmcpO1xuXG4gICAgaWYgKGRvY1R5cGUgPT09IFwiaW52b2ljZVwiKSB7XG4gICAgICB0aGlzLmJ0blByaW50LmlubmVyVGV4dCA9IFwiSW1wcmltZXIgbGEgZmFjdHVyZVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmJ0blByaW50LmlubmVyVGV4dCA9IFwiSW1wcmltZXIgbGUgZGV2aXNcIjtcbiAgICB9XG4gICAgdGhpcy5oaWRkZW5EaXYuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJ2aXNpYmlsaXR5OiB2aXNpYmxlO1wiKTtcbiAgICB0aGlzLmZvcm1Db250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSGFzUHJpbnQgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNQcmludFwiO1xuXG5leHBvcnQgY2xhc3MgUHJpbnQgaW1wbGVtZW50cyBIYXNQcmludCB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZWw6IEhUTUxEaXZFbGVtZW50KSB7fVxuICBwcmludCgpIHtcbiAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9IHRoaXMuZWwuaW5uZXJIVE1MOyAvLyBSZW1wbGFjZSBsZSBjb250ZW51IGRlIGxhIHBhZ2UgcGFyIGxlIGNvbnRlbnUgZHUgZGV2aXNcbiAgICB3aW5kb3cucHJpbnQoKSAvLyBJbXByaW1lIGxlIGNvbnRlbnUgZGUgbGEgcGFnZSBjJ2VzdC3DoC1kaXJlIGxlIGRldmlzXG4gICAgZG9jdW1lbnQubG9jYXRpb24ucmVsb2FkKCkgLy8gUmVjaGFyZ2UgbGEgcGFnZSBwb3VyIHJldmVuaXIgw6AgbCfDqXRhdCBpbml0aWFsXG4gIH1cbn1cbiIsImltcG9ydCB7IEhhc0h0bWxGb3JtYXQgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNIdG1sRm9ybWF0XCI7XG5pbXBvcnQgeyBIYXNQcmludCB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0hhc1ByaW50XCI7XG5pbXBvcnQgeyBIYXNSZW5kZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNSZW5kZXJcIjtcbmltcG9ydCB7IGJpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9CaW5kXCI7XG5pbXBvcnQgeyBEYXRhcyB9IGZyb20gXCIuL0RhdGFcIjtcbmltcG9ydCB7IERpc3BsYXkgfSBmcm9tIFwiLi9EaXNwbGF5XCI7XG5pbXBvcnQgeyBQcmludCB9IGZyb20gXCIuL1ByaW50XCI7XG5cbmV4cG9ydCBjbGFzcyBGb3JtSW5wdXQge1xuICBmb3JtOiBIVE1MRm9ybUVsZW1lbnQ7XG4gIHR5cGU6IEhUTUxTZWxlY3RFbGVtZW50O1xuICBmaXJzdE5hbWU6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gIGxhc3ROYW1lOiBIVE1MSW5wdXRFbGVtZW50O1xuICBhZGRyZXNzOiBIVE1MSW5wdXRFbGVtZW50O1xuICBjb3VudHJ5OiBIVE1MSW5wdXRFbGVtZW50O1xuICB0b3duOiBIVE1MSW5wdXRFbGVtZW50O1xuICB6aXA6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gIHByb2R1Y3Q6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gIHByaWNlOiBIVE1MSW5wdXRFbGVtZW50O1xuICBxdWFudGl0eTogSFRNTElucHV0RWxlbWVudDtcbiAgdHZhOiBIVE1MSW5wdXRFbGVtZW50O1xuXG4gIGRvY0NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG4gIGhpZGRlbkRpdjogSFRNTERpdkVsZW1lbnQ7XG4gIHN0b3JlZERhdGFEaXY6IEhUTUxEaXZFbGVtZW50O1xuXG4gIGJ0blByaW50OiBIVE1MQnV0dG9uRWxlbWVudDtcbiAgYnRuUmVsb2FkOiBIVE1MQnV0dG9uRWxlbWVudDtcbiAgYnRuU3RvcmVkSW52b2ljZXM6IEhUTUxCdXR0b25FbGVtZW50O1xuICBidG5TdG9yZWRFc3RpbWF0ZXM6IEhUTUxCdXR0b25FbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybVwiKSBhcyBIVE1MRm9ybUVsZW1lbnQ7XG4gICAgdGhpcy50eXBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0eXBlXCIpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xuICAgIHRoaXMuZmlyc3ROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmaXJzdE5hbWVcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLmxhc3ROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsYXN0TmFtZVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMuYWRkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkcmVzc1wiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMuY291bnRyeSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY291bnRyeVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMudG93biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG93blwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMuemlwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ6aXBcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLnByb2R1Y3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3RcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLnByaWNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcmljZVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMucXVhbnRpdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInF1YW50aXR5XCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy50dmEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInR2YVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXG4gICAgdGhpcy5kb2NDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAgIFwiYXNwZWN0LXJhdGlvLWNvbnRhaW5lclwiXG4gICAgKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICB0aGlzLmhpZGRlbkRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGlkZGVuRGl2XCIpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgIHRoaXMuc3RvcmVkRGF0YURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgXCJzdG9yZWQtZGF0YVwiXG4gICAgKSBhcyBIVE1MRGl2RWxlbWVudDtcblxuICAgIHRoaXMuYnRuUHJpbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByaW50XCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHRoaXMuYnRuUmVsb2FkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZWxvYWRcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgdGhpcy5idG5TdG9yZWRJbnZvaWNlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgXCJzdG9yZWQtaW52b2ljZXNcIlxuICAgICkgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgdGhpcy5idG5TdG9yZWRFc3RpbWF0ZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAgIFwic3RvcmVkLWVzdGltYXRlc1wiXG4gICAgKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblxuICAgIC8vIExpc3RlbmVyXG4gICAgdGhpcy5zdWJtaXRGb3JtTGlzdGVuZXIoKTtcbiAgICB0aGlzLnByaW50TGlzdGVuZXIoKTtcbiAgICB0aGlzLnJlbG9hZExpc3RlbmVyKCk7XG4gICAgdGhpcy5nZXRTdG9yZWREb2NzTGlzdGVuZXIoKTtcbiAgfVxuXG4gIC8vIExpc3RlbmVyXG4gIEBiaW5kIC8vIFBlcm1ldCBkZSBuZSBwYXMgcGVyZHJlIGxlIGNvbnRleHRlIGRlIGxhIG3DqXRob2RlXG4gIHByaXZhdGUgc3VibWl0Rm9ybUxpc3RlbmVyKCkge1xuICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuaGFuZGxlRm9ybVN1Ym1pdCk7IC8vIEdyw6JjZSBhdSBkw6ljb3JhdGV1ciBiaW5kIGlsIG4nZXN0IHBhcyBuw6ljZXNzYWlyZSBkZSBiaW5kIGxhIG3DqXRob2RlXG4gIH1cbiAgcHJpdmF0ZSBwcmludExpc3RlbmVyKCkge1xuICAgIHRoaXMuYnRuUHJpbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGxldCBhdmFpbGFibGVEb2M6IEhhc1ByaW50O1xuICAgICAgYXZhaWxhYmxlRG9jID0gbmV3IFByaW50KHRoaXMuZG9jQ29udGFpbmVyKTtcbiAgICAgIGF2YWlsYWJsZURvYy5wcmludCgpO1xuICAgIH0pO1xuICB9XG4gIHByaXZhdGUgcmVsb2FkTGlzdGVuZXIoKSB7XG4gICAgdGhpcy5idG5SZWxvYWQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xuICAgIH0pO1xuICB9XG4gIHByaXZhdGUgZ2V0U3RvcmVkRG9jc0xpc3RlbmVyKCk6IHZvaWQge1xuICAgIC8vIERhbnMgY2V0IGV4ZW1wbGUsIGxlcyBmb25jdGlvbnMgZmzDqWNow6llcyAoKSA9PiB0aGlzLmdldEl0ZW1zKFwiaW52b2ljZVwiKSBldCAoKSA9PiB0aGlzLmdldEl0ZW1zKFwiZXN0aW1hdGVcIikgY29uc2VydmVudCBsZSBjb250ZXh0ZSBkZSB0aGlzIHNhbnMgYXZvaXIgYmVzb2luIGQndXRpbGlzZXIgYmluZCgpLlxuICAgIC8vIENlbGEgZm9uY3Rpb25uZSBwYXJjZSBxdWUgbGVzIGZvbmN0aW9ucyBmbMOpY2jDqWVzIG4nb250IHBhcyBsZXVyIHByb3ByZSBjb250ZXh0ZSB0aGlzLCBlbGxlcyBsZSBwcmVubmVudCBkZSBsJ2VuY2xvcyBlbmdsb2JhbnQuXG4gICAgdGhpcy5idG5TdG9yZWRJbnZvaWNlcy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuZ2V0SXRlbXMoXCJpbnZvaWNlXCIpXG4gICAgKTtcbiAgICB0aGlzLmJ0blN0b3JlZEVzdGltYXRlcy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuZ2V0SXRlbXMoXCJlc3RpbWF0ZVwiKVxuICAgICk7XG4gIH1cblxuICAvLyBSw6ljdXDDqXJlIGxlcyBmYWN0dXJlL2RldmlzIGR1IGxvY2FsIHN0b3JhZ2UgcG91ciBsZXMgYWZmaWNoZXJcbiAgcHJpdmF0ZSBnZXRJdGVtcyhkb2NUeXBlOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5zdG9yZWREYXRhRGl2Lmhhc0NoaWxkTm9kZXMoKSkge1xuICAgICAgdGhpcy5zdG9yZWREYXRhRGl2LmlubmVySFRNTCA9IFwiXCI7XG4gICAgfVxuXG4gICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGRvY1R5cGUpKSB7XG4gICAgICBsZXQgYXJyYXk6IHN0cmluZyB8IG51bGw7XG4gICAgICBhcnJheSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGRvY1R5cGUpO1xuXG4gICAgICBpZiAoYXJyYXkgIT09IG51bGwgJiYgYXJyYXkubGVuZ3RoID4gMikge1xuICAgICAgICBsZXQgYXJyYXlEYXRhOiBzdHJpbmdbXTtcbiAgICAgICAgYXJyYXlEYXRhID0gSlNPTi5wYXJzZShhcnJheSk7XG4gICAgICAgIGFycmF5RGF0YS5tYXAoKGRvYzogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgbGV0IGNhcmQ6IEhUTUxEaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICBsZXQgY2FyZEJvZHk6IEhUTUxEaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICBsZXQgY2FyZEJvZHlDbGFzc2VzOiBzdHJpbmcgPSBcImNhcmQtYm9keVwiO1xuICAgICAgICAgIGNhcmQuY2xhc3NMaXN0LmFkZChcImNhcmQtY2xhc3Nlc1wiKTtcbiAgICAgICAgICBjYXJkQm9keS5jbGFzc0xpc3QuYWRkKGNhcmRCb2R5Q2xhc3Nlcyk7XG5cbiAgICAgICAgICBjYXJkQm9keS5pbm5lckhUTUwgPSBkb2M7XG4gICAgICAgICAgY2FyZC5hcHBlbmQoY2FyZEJvZHkpO1xuICAgICAgICAgIHRoaXMuc3RvcmVkRGF0YURpdi5hcHBlbmQoY2FyZCk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zdG9yZWREYXRhRGl2LmlubmVySFRNTCA9IGA8ZGl2PkF1Y3VuJHtcbiAgICAgICAgICBkb2NUeXBlID09PSBcImludm9pY2VcIiA/IFwiZSBmYWN0dXJlXCIgOiBcIiBkZXZpc1wiXG4gICAgICAgIH0gZGlzcG9uaWJsZSAhPC9kaXY+YDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBIYW5kbGUgRm9ybVxuICBAYmluZFxuICBwcml2YXRlIGhhbmRsZUZvcm1TdWJtaXQoZTogRXZlbnQpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICB0aGlzLmhpZGVMaXN0RG9jdW1lbnRzKCk7XG5cbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLmlucHV0RGF0YXMoKTsgLy8gQXJyYXkgb3UgVW5kZWZpbmVkXG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShpbnB1dHMpKSB7XG4gICAgICBjb25zdCBbXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGZpcnN0TmFtZSxcbiAgICAgICAgbGFzdE5hbWUsXG4gICAgICAgIGFkZHJlc3MsXG4gICAgICAgIGNvdW50cnksXG4gICAgICAgIHRvd24sXG4gICAgICAgIHppcCxcbiAgICAgICAgcHJvZHVjdCxcbiAgICAgICAgcHJpY2UsXG4gICAgICAgIHF1YW50aXR5LFxuICAgICAgICB0dmEsXG4gICAgICBdID0gaW5wdXRzO1xuXG4gICAgICBsZXQgZG9jRGF0YTogSGFzSHRtbEZvcm1hdDtcbiAgICAgIGxldCBkYXRlOiBEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgIGRvY0RhdGEgPSBuZXcgRGF0YXMoLi4uaW5wdXRzLCBkYXRlKTtcblxuICAgICAgbGV0IHRlbXBsYXRlOiBIYXNSZW5kZXI7XG4gICAgICB0ZW1wbGF0ZSA9IG5ldyBEaXNwbGF5KHRoaXMuZG9jQ29udGFpbmVyLCB0aGlzLmhpZGRlbkRpdiwgdGhpcy5idG5QcmludCk7XG4gICAgICB0ZW1wbGF0ZS5yZW5kZXIoZG9jRGF0YSwgdHlwZSk7XG4gICAgfVxuICB9XG4gIHByaXZhdGUgaGlkZUxpc3REb2N1bWVudHMoKSB7XG4gICAgdGhpcy5idG5TdG9yZWRJbnZvaWNlcy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcInZpc2liaWxpdHk6IGhpZGRlblwiKTtcbiAgICB0aGlzLmJ0blN0b3JlZEVzdGltYXRlcy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcInZpc2liaWxpdHk6IGhpZGRlblwiKTtcbiAgICB0aGlzLnN0b3JlZERhdGFEaXYuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJ2aXNpYmlsaXR5OiBoaWRkZW5cIik7XG4gIH1cblxuICAvLyBUdXBsZVxuICBwcml2YXRlIGlucHV0RGF0YXMoKTpcbiAgICB8IFtcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBzdHJpbmcsXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBzdHJpbmcsXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgbnVtYmVyLFxuICAgICAgICBzdHJpbmcsXG4gICAgICAgIG51bWJlcixcbiAgICAgICAgbnVtYmVyLFxuICAgICAgICBudW1iZXJcbiAgICAgIF1cbiAgICB8IHZvaWQge1xuICAgIGNvbnN0IHR5cGUgPSB0aGlzLnR5cGUudmFsdWU7XG4gICAgY29uc3QgZmlyc3ROYW1lID0gdGhpcy5maXJzdE5hbWUudmFsdWU7XG4gICAgY29uc3QgbGFzdE5hbWUgPSB0aGlzLmxhc3ROYW1lLnZhbHVlO1xuICAgIGNvbnN0IGFkZHJlc3MgPSB0aGlzLmFkZHJlc3MudmFsdWU7XG4gICAgY29uc3QgY291bnRyeSA9IHRoaXMuY291bnRyeS52YWx1ZTtcbiAgICBjb25zdCB0b3duID0gdGhpcy50b3duLnZhbHVlO1xuICAgIGNvbnN0IHppcCA9IHRoaXMuemlwLnZhbHVlQXNOdW1iZXI7XG4gICAgY29uc3QgcHJvZHVjdCA9IHRoaXMucHJvZHVjdC52YWx1ZTtcbiAgICBjb25zdCBwcmljZSA9IHRoaXMucHJpY2UudmFsdWVBc051bWJlcjtcbiAgICBjb25zdCBxdWFudGl0eSA9IHRoaXMucXVhbnRpdHkudmFsdWVBc051bWJlcjtcbiAgICBjb25zdCB0dmEgPSB0aGlzLnR2YS52YWx1ZUFzTnVtYmVyO1xuXG4gICAgaWYgKHppcCA+IDAgJiYgcHJpY2UgPiAwICYmIHF1YW50aXR5ID4gMCAmJiB0dmEgPiAwKSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICB0eXBlLFxuICAgICAgICBmaXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lLFxuICAgICAgICBhZGRyZXNzLFxuICAgICAgICBjb3VudHJ5LFxuICAgICAgICB0b3duLFxuICAgICAgICB6aXAsXG4gICAgICAgIHByb2R1Y3QsXG4gICAgICAgIHByaWNlLFxuICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgdHZhLFxuICAgICAgXTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWxlcnQoXCJMZXMgdmFsZXVycyBudW3DqXJpcXVlcyBkb2l2ZW50IMOqdHJlIHN1cMOpcmlldXIgw6AgesOpcm8gIVwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IEZvcm1JbnB1dCB9IGZyb20gXCIuL2NsYXNzZXMvRm9ybUlucHV0XCI7XG5pbXBvcnQgeyBTdG9yYWdlIH0gZnJvbSBcIi4vY2xhc3Nlcy9TdG9yYWdlXCI7XG5cbm5ldyBGb3JtSW5wdXQoKTtcblN0b3JhZ2UuY2hlY2tMb2NhbFN0b3JhZ2UoKTtcblxuIl0sIm5hbWVzIjpbImJpbmQiLCJ0YXJnZXQiLCJtZXRob2ROYW1lIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwidGhpcyIsIkRhdGFzIiwiY29uc3RydWN0b3IiLCJkb2N1bWVudFR5cGUiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImFkZHJlc3MiLCJjb3VudHJ5IiwidG93biIsInppcCIsInByb2R1Y3QiLCJwcmljZSIsInF1YW50aXR5IiwidHZhIiwiZGF0ZSIsInN1YlRvdGFsIiwiaHRtbEZvcm1hdCIsInRvdGFsUHJpY2UiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJ0b0ZpeGVkIiwiU3RvcmFnZSIsInR5cGVWYWx1ZSIsImh0bWxTdHJpbmciLCJvbGREYXRhIiwic2V0SXRlbSIsImNoZWNrTG9jYWxTdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImFycmF5IiwiSlNPTiIsInBhcnNlIiwicHVzaCIsInN0cmluZ2lmeSIsImRvY3VtZW50IiwibG9jYXRpb24iLCJyZWxvYWQiLCJEaXNwbGF5IiwiY29udGFpbmVyIiwiaGlkZGVuRGl2IiwiYnRuUHJpbnQiLCJmb3JtQ29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW5kZXIiLCJkb2NPYmoiLCJkb2NUeXBlIiwiaW5uZXJIVE1MIiwiaW5uZXJUZXh0Iiwic2V0QXR0cmlidXRlIiwiUHJpbnQiLCJlbCIsInByaW50IiwiYm9keSIsIndpbmRvdyIsIkZvcm1JbnB1dCIsImZvcm0iLCJ0eXBlIiwiZG9jQ29udGFpbmVyIiwic3RvcmVkRGF0YURpdiIsImJ0blJlbG9hZCIsImJ0blN0b3JlZEludm9pY2VzIiwiYnRuU3RvcmVkRXN0aW1hdGVzIiwic3VibWl0Rm9ybUxpc3RlbmVyIiwicHJpbnRMaXN0ZW5lciIsInJlbG9hZExpc3RlbmVyIiwiZ2V0U3RvcmVkRG9jc0xpc3RlbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZUZvcm1TdWJtaXQiLCJhdmFpbGFibGVEb2MiLCJzY3JvbGxUbyIsImdldEl0ZW1zIiwiaGFzQ2hpbGROb2RlcyIsImxlbmd0aCIsImFycmF5RGF0YSIsIm1hcCIsImRvYyIsImNhcmQiLCJjcmVhdGVFbGVtZW50IiwiY2FyZEJvZHkiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmQiLCJlIiwicHJldmVudERlZmF1bHQiLCJoaWRlTGlzdERvY3VtZW50cyIsImlucHV0cyIsImlucHV0RGF0YXMiLCJBcnJheSIsImlzQXJyYXkiLCJkb2NEYXRhIiwidGVtcGxhdGUiLCJEYXRlIiwidmFsdWVBc051bWJlciIsImFsZXJ0Il0sInNvdXJjZVJvb3QiOiIifQ==