(()=>{"use strict";function t(t,e,i){const n=i.value;return{configurable:!0,enumerable:!1,get(){return n.bind(this)}}}class e{constructor(t,e,i,n,s,o,r,d,a,l,c,h){this.documentType=t,this.firstName=e,this.lastName=i,this.address=n,this.country=s,this.town=o,this.zip=r,this.product=d,this.price=a,this.quantity=l,this.tva=c,this.date=h}subTotal(t,e,i){return(t+t*(i/100))*e}htmlFormat(){const t=this.subTotal(this.price,this.quantity,this.tva);return`\n        <div id="document-container">\n          <div class="document-header">\n            <div>\n              <img class="logo-ed" src="./medias/Logo ED SVG.svg">\n            </div>\n            <div>\n              <p>${"invoice"===this.documentType?"Facture":"Devis"}<span> N° ${Math.floor(101*Math.random())}</span></p>\n              <p>Date <span>${this.date.toLocaleDateString()}</span></p>\n            </div>\n          </div>\n        \n          <div class="document-informations">\n            <div>\n              <p>ED</p>\n              <p>22 rue des Champs-Élysées</p>\n              <p>75008 Paris</p>\n              <p>Tel: +33 6 36 37 89 27</p>\n            </div>\n            <div>\n              <p>Informations du client</p>\n              <p>${this.lastName} ${this.firstName}</p>\n              <p>${this.address} </p>\n              <p>${this.zip}</p>\n              <p>${this.town}</p>\n              <p>${this.country}</p>\n            </div>\n          </div>\n        \n          <div class="document-product">\n            <div>\n              <table>\n                <thead>\n                  <tr>\n                    <th>Produit/Service</th>\n                    <th>Prix unitaire</th>\n                    <th>Quantité</th>\n                    <th>Total HT</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td>${this.product}</td>\n                    <td>${this.price} €</td>\n                    <td>${this.quantity}</td>\n                    <td>${this.price*this.quantity} € HT</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n          <div class="document-total">\n            <div>\n              <div>TOTAL TTC</div>\n              <div>${t.toFixed(2)} €</div>\n            </div>\n          </div>\n        </div>\n\n    `}}class i{constructor(t,e){this.oldData=[],this.setItem(t,e)}static checkLocalStorage(){null===localStorage.getItem("invoice")&&localStorage.setItem("invoice","[]"),null===localStorage.getItem("estimate")&&localStorage.setItem("estimate","[]")}setItem(t,e){let i;i=localStorage.getItem(t),null!==i?(this.oldData=JSON.parse(i),this.oldData.push(e),localStorage.setItem(t,JSON.stringify(this.oldData))):document.location.reload()}}class n{constructor(t,e,i){this.container=t,this.hiddenDiv=e,this.btnPrint=i,this.formContainer=document.getElementById("form-container")}render(t,e){const n=t.htmlFormat();this.container.innerHTML=n,new i(e,n),this.btnPrint.innerText="invoice"===e?"Imprimer la facture":"Imprimer le devis",this.hiddenDiv.setAttribute("style","display: contents;"),this.formContainer.innerHTML=""}}class s{constructor(t){this.el=t}print(){document.body.innerHTML=this.el.innerHTML,window.print(),document.location.reload()}}var o=function(t,e,i,n){var s,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var d=t.length-1;d>=0;d--)(s=t[d])&&(r=(o<3?s(r):o>3?s(e,i,r):s(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r};class r{constructor(){this.form=document.getElementById("form"),this.type=document.getElementById("type"),this.firstName=document.getElementById("firstName"),this.lastName=document.getElementById("lastName"),this.address=document.getElementById("address"),this.country=document.getElementById("country"),this.town=document.getElementById("town"),this.zip=document.getElementById("zip"),this.product=document.getElementById("product"),this.price=document.getElementById("price"),this.quantity=document.getElementById("quantity"),this.tva=document.getElementById("tva"),this.docContainer=document.getElementById("aspect-ratio-container"),this.hiddenDiv=document.getElementById("hiddenDiv"),this.storedDataDiv=document.getElementById("stored-data"),this.btnPrint=document.getElementById("print"),this.btnReload=document.getElementById("reload"),this.btnStoredInvoices=document.getElementById("stored-invoices"),this.btnStoredEstimates=document.getElementById("stored-estimates"),this.submitFormListener(),this.printListener(),this.reloadListener(),this.getStoredDocsListener()}submitFormListener(){this.form.addEventListener("submit",this.handleFormSubmit)}printListener(){this.btnPrint.addEventListener("click",(()=>{let t;t=new s(this.docContainer),t.print()}))}reloadListener(){this.btnReload.addEventListener("click",(()=>{document.location.reload(),window.scrollTo(0,0)}))}getStoredDocsListener(){this.btnStoredInvoices.addEventListener("click",(()=>this.getItems("invoice"))),this.btnStoredEstimates.addEventListener("click",(()=>this.getItems("estimate")))}getItems(t){if(this.storedDataDiv.hasChildNodes()&&(this.storedDataDiv.innerHTML=""),localStorage.getItem(t)){let e;if(e=localStorage.getItem(t),null!==e&&e.length>2){let t;t=JSON.parse(e),t.map((t=>{let e=document.createElement("div"),i=document.createElement("div");e.classList.add("card-classes"),i.classList.add("card-body"),i.innerHTML=t,e.append(i),this.storedDataDiv.append(e)}))}else this.storedDataDiv.innerHTML=`<div>Aucun${"invoice"===t?"e facture":" devis"} disponible !</div>`}}handleFormSubmit(t){t.preventDefault(),this.hideListDocuments();const i=this.inputDatas();if(Array.isArray(i)){const[t,s,o,r,d,a,l,c,h,m,u]=i;let p,v,y=new Date;p=new e(...i,y),v=new n(this.docContainer,this.hiddenDiv,this.btnPrint),v.render(p,t)}}hideListDocuments(){this.btnStoredInvoices.setAttribute("style","display: none"),this.btnStoredEstimates.setAttribute("style","display: none"),this.storedDataDiv.setAttribute("style","display: none")}inputDatas(){const t=this.type.value,e=this.firstName.value,i=this.lastName.value,n=this.address.value,s=this.country.value,o=this.town.value,r=this.zip.valueAsNumber,d=this.product.value,a=this.price.valueAsNumber,l=this.quantity.valueAsNumber,c=this.tva.valueAsNumber;return r>0&&a>0&&l>0&&c>0?[t,e,i,n,s,o,r,d,a,l,c]:void alert("Les valeurs numériques doivent être supérieur à zéro !")}}o([t],r.prototype,"submitFormListener",null),o([t],r.prototype,"handleFormSubmit",null),new r,i.checkLocalStorage(),console.log("Hello World")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixFQUFVLElBQUkxRixLQUFTc0YsRUFBUXpFLEdBRy9COEUsRUFBVyxJQUFJckQsRUFBUXZDLEtBQUsyRCxhQUFjM0QsS0FBS3lDLFVBQVd6QyxLQUFLMEMsVUFDL0RrRCxFQUFTL0MsT0FBTzhDLEVBQVNqQyxFQUMzQixDQUNGLENBQ1EsaUJBQUE0QixHQUNOdEYsS0FBSzhELGtCQUFrQlosYUFBYSxRQUFTLGlCQUM3Q2xELEtBQUsrRCxtQkFBbUJiLGFBQWEsUUFBUyxpQkFDOUNsRCxLQUFLNEQsY0FBY1YsYUFBYSxRQUFTLGdCQUMzQyxDQUdRLFVBQUFzQyxHQWVOLE1BQU05QixFQUFPMUQsS0FBSzBELEtBQUs5RCxNQUNqQlEsRUFBWUosS0FBS0ksVUFBVVIsTUFDM0JTLEVBQVdMLEtBQUtLLFNBQVNULE1BQ3pCVSxFQUFVTixLQUFLTSxRQUFRVixNQUN2QlcsRUFBVVAsS0FBS08sUUFBUVgsTUFDdkJZLEVBQU9SLEtBQUtRLEtBQUtaLE1BQ2pCYSxFQUFNVCxLQUFLUyxJQUFJcUYsY0FDZnBGLEVBQVVWLEtBQUtVLFFBQVFkLE1BQ3ZCZSxFQUFRWCxLQUFLVyxNQUFNbUYsY0FDbkJsRixFQUFXWixLQUFLWSxTQUFTa0YsY0FDekJqRixFQUFNYixLQUFLYSxJQUFJaUYsY0FFckIsT0FBSXJGLEVBQU0sR0FBS0UsRUFBUSxHQUFLQyxFQUFXLEdBQUtDLEVBQU0sRUFDekMsQ0FDTDZDLEVBQ0F0RCxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxRQUdGa0YsTUFBTSx5REFHVixFQWhKUSxHQURQeEcsRyx1Q0E4RE8sR0FEUEEsRyxxQ0NoSUgsSUFBSWlFLEVBQ0pqQyxFQUFRSyxvQkFFUm9FLFFBQVFDLElBQUksYyIsInNvdXJjZXMiOlsid2VicGFjazovL2ZhY3R1cmllci8uL3NyYy9kZWNvcmF0b3JzL0JpbmQudHMiLCJ3ZWJwYWNrOi8vZmFjdHVyaWVyLy4vc3JjL2NsYXNzZXMvRGF0YS50cyIsIndlYnBhY2s6Ly9mYWN0dXJpZXIvLi9zcmMvY2xhc3Nlcy9TdG9yYWdlLnRzIiwid2VicGFjazovL2ZhY3R1cmllci8uL3NyYy9jbGFzc2VzL0Rpc3BsYXkudHMiLCJ3ZWJwYWNrOi8vZmFjdHVyaWVyLy4vc3JjL2NsYXNzZXMvUHJpbnQudHMiLCJ3ZWJwYWNrOi8vZmFjdHVyaWVyLy4vc3JjL2NsYXNzZXMvRm9ybUlucHV0LnRzIiwid2VicGFjazovL2ZhY3R1cmllci8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMZSBkw6ljb3JhdGV1ciBiaW5kIHBlcm1ldCBkZSBsaWVyIGxhIG3DqXRob2RlIMOgIGwnaW5zdGFuY2UgZGUgbGEgY2xhc3NlXG5leHBvcnQgZnVuY3Rpb24gYmluZCh0YXJnZXQ6IGFueSwgbWV0aG9kTmFtZTogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpIHtcbiAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICBsZXQgbmV3RGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICBnZXQoKSB7XG4gICAgICByZXR1cm4gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcbiAgICB9LFxuICB9O1xuICByZXR1cm4gbmV3RGVzY3JpcHRvcjtcbn1cbiIsImltcG9ydCB7IEhhc0h0bWxGb3JtYXQgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNIdG1sRm9ybWF0XCI7XG5cbmV4cG9ydCBjbGFzcyBEYXRhcyBpbXBsZW1lbnRzIEhhc0h0bWxGb3JtYXQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGRvY3VtZW50VHlwZTogc3RyaW5nLFxuICAgIHByaXZhdGUgZmlyc3ROYW1lOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBsYXN0TmFtZTogc3RyaW5nLFxuICAgIHByaXZhdGUgYWRkcmVzczogc3RyaW5nLFxuICAgIHByaXZhdGUgY291bnRyeTogc3RyaW5nLFxuICAgIHByaXZhdGUgdG93bjogc3RyaW5nLFxuICAgIHByaXZhdGUgemlwOiBudW1iZXIsXG4gICAgcHJpdmF0ZSBwcm9kdWN0OiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBwcmljZTogbnVtYmVyLFxuICAgIHByaXZhdGUgcXVhbnRpdHk6IG51bWJlcixcbiAgICBwcml2YXRlIHR2YTogbnVtYmVyLFxuICAgIHByaXZhdGUgZGF0ZTogRGF0ZVxuICApIHt9XG5cbiAgcHJpdmF0ZSBzdWJUb3RhbChwcmljZTogbnVtYmVyLCBxdWFudGl0eTogbnVtYmVyLCB0dmE6IG51bWJlcik6IG51bWJlciB7XG4gICAgY29uc3QgdHZhUGVyY2VudCA9IHR2YSAvIDEwMDsgLy8gMjAlID0gMCwyXG4gICAgY29uc3QgdG90YWxUdmEgPSBwcmljZSAqIHR2YVBlcmNlbnQ7XG4gICAgcmV0dXJuIChwcmljZSArIHRvdGFsVHZhKSAqIHF1YW50aXR5O1xuICB9XG5cbiAgaHRtbEZvcm1hdCgpOiBzdHJpbmcge1xuICAgIGNvbnN0IHRvdGFsUHJpY2UgPSB0aGlzLnN1YlRvdGFsKHRoaXMucHJpY2UsIHRoaXMucXVhbnRpdHksIHRoaXMudHZhKTtcbiAgICByZXR1cm4gYFxuICAgICAgICA8ZGl2IGlkPVwiZG9jdW1lbnQtY29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImRvY3VtZW50LWhlYWRlclwiPlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgPGltZyBjbGFzcz1cImxvZ28tZWRcIiBzcmM9XCIuL21lZGlhcy9Mb2dvIEVEIFNWRy5zdmdcIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgPHA+JHtcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50VHlwZSA9PT0gXCJpbnZvaWNlXCIgPyBcIkZhY3R1cmVcIiA6IFwiRGV2aXNcIlxuICAgICAgICAgICAgICB9PHNwYW4+IE7CsCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMSl9PC9zcGFuPjwvcD5cbiAgICAgICAgICAgICAgPHA+RGF0ZSA8c3Bhbj4ke3RoaXMuZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX08L3NwYW4+PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJkb2N1bWVudC1pbmZvcm1hdGlvbnNcIj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxwPkVEPC9wPlxuICAgICAgICAgICAgICA8cD4yMiBydWUgZGVzIENoYW1wcy3DiWx5c8OpZXM8L3A+XG4gICAgICAgICAgICAgIDxwPjc1MDA4IFBhcmlzPC9wPlxuICAgICAgICAgICAgICA8cD5UZWw6ICszMyA2IDM2IDM3IDg5IDI3PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8cD5JbmZvcm1hdGlvbnMgZHUgY2xpZW50PC9wPlxuICAgICAgICAgICAgICA8cD4ke3RoaXMubGFzdE5hbWV9ICR7dGhpcy5maXJzdE5hbWV9PC9wPlxuICAgICAgICAgICAgICA8cD4ke3RoaXMuYWRkcmVzc30gPC9wPlxuICAgICAgICAgICAgICA8cD4ke3RoaXMuemlwfTwvcD5cbiAgICAgICAgICAgICAgPHA+JHt0aGlzLnRvd259PC9wPlxuICAgICAgICAgICAgICA8cD4ke3RoaXMuY291bnRyeX08L3A+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImRvY3VtZW50LXByb2R1Y3RcIj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDx0YWJsZT5cbiAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgIDx0aD5Qcm9kdWl0L1NlcnZpY2U8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8dGg+UHJpeCB1bml0YWlyZTwvdGg+XG4gICAgICAgICAgICAgICAgICAgIDx0aD5RdWFudGl0w6k8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8dGg+VG90YWwgSFQ8L3RoPlxuICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgPHRkPiR7dGhpcy5wcm9kdWN0fTwvdGQ+XG4gICAgICAgICAgICAgICAgICAgIDx0ZD4ke3RoaXMucHJpY2V9IOKCrDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgIDx0ZD4ke3RoaXMucXVhbnRpdHl9PC90ZD5cbiAgICAgICAgICAgICAgICAgICAgPHRkPiR7dGhpcy5wcmljZSAqIHRoaXMucXVhbnRpdHl9IOKCrCBIVDwvdGQ+XG4gICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZG9jdW1lbnQtdG90YWxcIj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxkaXY+VE9UQUwgVFRDPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXY+JHt0b3RhbFByaWNlLnRvRml4ZWQoMil9IOKCrDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgYDtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSGFzU2V0SXRlbSB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0hhc1NldEl0ZW1cIjtcblxuZXhwb3J0IGNsYXNzIFN0b3JhZ2UgaW1wbGVtZW50cyBIYXNTZXRJdGVtIHtcbiAgb2xkRGF0YTogc3RyaW5nW10gPSBbXTtcblxuICBjb25zdHJ1Y3Rvcih0eXBlVmFsdWU6IHN0cmluZywgaHRtbFN0cmluZzogc3RyaW5nKSB7XG4gICAgdGhpcy5zZXRJdGVtKHR5cGVWYWx1ZSwgaHRtbFN0cmluZyk7XG4gIH1cbiAgc3RhdGljIGNoZWNrTG9jYWxTdG9yYWdlKCk6IHZvaWQge1xuICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImludm9pY2VcIikgPT09IG51bGwpIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiaW52b2ljZVwiLCBcIltdXCIpO1xuICAgIH1cbiAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJlc3RpbWF0ZVwiKSA9PT0gbnVsbCkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJlc3RpbWF0ZVwiLCBcIltdXCIpO1xuICAgIH1cbiAgfVxuXG4gIHNldEl0ZW0odHlwZVZhbHVlOiBzdHJpbmcsIGh0bWxTdHJpbmc6IHN0cmluZyk6IHZvaWQge1xuICAgIGxldCBhcnJheTogc3RyaW5nIHwgbnVsbDtcbiAgICBhcnJheSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHR5cGVWYWx1ZSk7XG4gICAgaWYgKGFycmF5ICE9PSBudWxsKSB7XG4gICAgICB0aGlzLm9sZERhdGEgPSBKU09OLnBhcnNlKGFycmF5KTtcbiAgICAgIHRoaXMub2xkRGF0YS5wdXNoKGh0bWxTdHJpbmcpO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odHlwZVZhbHVlLCBKU09OLnN0cmluZ2lmeSh0aGlzLm9sZERhdGEpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZG9jdW1lbnQubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBIYXNSZW5kZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNSZW5kZXJcIjtcbmltcG9ydCB7IEhhc0h0bWxGb3JtYXQgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNIdG1sRm9ybWF0XCI7XG5pbXBvcnQgeyBTdG9yYWdlIH0gZnJvbSBcIi4vU3RvcmFnZVwiO1xuXG5leHBvcnQgY2xhc3MgRGlzcGxheSBpbXBsZW1lbnRzIEhhc1JlbmRlciB7XG4gIGZvcm1Db250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCxcbiAgICBwcml2YXRlIGhpZGRlbkRpdjogSFRNTERpdkVsZW1lbnQsXG4gICAgcHJpdmF0ZSBidG5QcmludDogSFRNTEJ1dHRvbkVsZW1lbnRcbiAgKSB7XG4gICAgdGhpcy5mb3JtQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgICBcImZvcm0tY29udGFpbmVyXCJcbiAgICApIGFzIEhUTUxEaXZFbGVtZW50O1xuICB9XG4gIHJlbmRlcihkb2NPYmo6IEhhc0h0bWxGb3JtYXQsIGRvY1R5cGU6IHN0cmluZykge1xuICAgIGNvbnN0IGh0bWxTdHJpbmc6IHN0cmluZyA9IGRvY09iai5odG1sRm9ybWF0KCk7XG4gICAgdGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gaHRtbFN0cmluZztcblxuICAgIG5ldyBTdG9yYWdlKGRvY1R5cGUsIGh0bWxTdHJpbmcpO1xuXG4gICAgaWYgKGRvY1R5cGUgPT09IFwiaW52b2ljZVwiKSB7XG4gICAgICB0aGlzLmJ0blByaW50LmlubmVyVGV4dCA9IFwiSW1wcmltZXIgbGEgZmFjdHVyZVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmJ0blByaW50LmlubmVyVGV4dCA9IFwiSW1wcmltZXIgbGUgZGV2aXNcIjtcbiAgICB9XG4gICAgdGhpcy5oaWRkZW5EaXYuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBjb250ZW50cztcIik7XG4gICAgdGhpcy5mb3JtQ29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XG4gIH1cbn1cbiIsImltcG9ydCB7IEhhc1ByaW50IH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvSGFzUHJpbnRcIjtcblxuZXhwb3J0IGNsYXNzIFByaW50IGltcGxlbWVudHMgSGFzUHJpbnQge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsOiBIVE1MRGl2RWxlbWVudCkge31cbiAgcHJpbnQoKSB7XG4gICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSB0aGlzLmVsLmlubmVySFRNTDsgLy8gUmVtcGxhY2UgbGUgY29udGVudSBkZSBsYSBwYWdlIHBhciBsZSBjb250ZW51IGR1IGRldmlzXG4gICAgd2luZG93LnByaW50KCkgLy8gSW1wcmltZSBsZSBjb250ZW51IGRlIGxhIHBhZ2UgYydlc3Qtw6AtZGlyZSBsZSBkZXZpc1xuICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpIC8vIFJlY2hhcmdlIGxhIHBhZ2UgcG91ciByZXZlbmlyIMOgIGwnw6l0YXQgaW5pdGlhbFxuICB9XG59XG4iLCJpbXBvcnQgeyBIYXNIdG1sRm9ybWF0IH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvSGFzSHRtbEZvcm1hdFwiO1xuaW1wb3J0IHsgSGFzUHJpbnQgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9IYXNQcmludFwiO1xuaW1wb3J0IHsgSGFzUmVuZGVyIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvSGFzUmVuZGVyXCI7XG5pbXBvcnQgeyBiaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvQmluZFwiO1xuaW1wb3J0IHsgRGF0YXMgfSBmcm9tIFwiLi9EYXRhXCI7XG5pbXBvcnQgeyBEaXNwbGF5IH0gZnJvbSBcIi4vRGlzcGxheVwiO1xuaW1wb3J0IHsgUHJpbnQgfSBmcm9tIFwiLi9QcmludFwiO1xuXG5leHBvcnQgY2xhc3MgRm9ybUlucHV0IHtcbiAgZm9ybTogSFRNTEZvcm1FbGVtZW50O1xuICB0eXBlOiBIVE1MU2VsZWN0RWxlbWVudDtcbiAgZmlyc3ROYW1lOiBIVE1MSW5wdXRFbGVtZW50O1xuICBsYXN0TmFtZTogSFRNTElucHV0RWxlbWVudDtcbiAgYWRkcmVzczogSFRNTElucHV0RWxlbWVudDtcbiAgY291bnRyeTogSFRNTElucHV0RWxlbWVudDtcbiAgdG93bjogSFRNTElucHV0RWxlbWVudDtcbiAgemlwOiBIVE1MSW5wdXRFbGVtZW50O1xuICBwcm9kdWN0OiBIVE1MSW5wdXRFbGVtZW50O1xuICBwcmljZTogSFRNTElucHV0RWxlbWVudDtcbiAgcXVhbnRpdHk6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gIHR2YTogSFRNTElucHV0RWxlbWVudDtcblxuICBkb2NDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xuICBoaWRkZW5EaXY6IEhUTUxEaXZFbGVtZW50O1xuICBzdG9yZWREYXRhRGl2OiBIVE1MRGl2RWxlbWVudDtcblxuICBidG5QcmludDogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gIGJ0blJlbG9hZDogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gIGJ0blN0b3JlZEludm9pY2VzOiBIVE1MQnV0dG9uRWxlbWVudDtcbiAgYnRuU3RvcmVkRXN0aW1hdGVzOiBIVE1MQnV0dG9uRWxlbWVudDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvcm1cIikgYXMgSFRNTEZvcm1FbGVtZW50O1xuICAgIHRoaXMudHlwZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHlwZVwiKSBhcyBIVE1MU2VsZWN0RWxlbWVudDtcbiAgICB0aGlzLmZpcnN0TmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmlyc3ROYW1lXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy5sYXN0TmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibGFzdE5hbWVcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLmFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZHJlc3NcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLmNvdW50cnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvdW50cnlcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLnRvd24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvd25cIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLnppcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiemlwXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy5wcm9kdWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9kdWN0XCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy5wcmljZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJpY2VcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLnF1YW50aXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJxdWFudGl0eVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMudHZhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0dmFcIikgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgIHRoaXMuZG9jQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgICBcImFzcGVjdC1yYXRpby1jb250YWluZXJcIlxuICAgICkgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgdGhpcy5oaWRkZW5EaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhpZGRlbkRpdlwiKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICB0aGlzLnN0b3JlZERhdGFEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAgIFwic3RvcmVkLWRhdGFcIlxuICAgICkgYXMgSFRNTERpdkVsZW1lbnQ7XG5cbiAgICB0aGlzLmJ0blByaW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcmludFwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICB0aGlzLmJ0blJlbG9hZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVsb2FkXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHRoaXMuYnRuU3RvcmVkSW52b2ljZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAgIFwic3RvcmVkLWludm9pY2VzXCJcbiAgICApIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHRoaXMuYnRuU3RvcmVkRXN0aW1hdGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgICBcInN0b3JlZC1lc3RpbWF0ZXNcIlxuICAgICkgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cbiAgICAvLyBMaXN0ZW5lclxuICAgIHRoaXMuc3VibWl0Rm9ybUxpc3RlbmVyKCk7XG4gICAgdGhpcy5wcmludExpc3RlbmVyKCk7XG4gICAgdGhpcy5yZWxvYWRMaXN0ZW5lcigpO1xuICAgIHRoaXMuZ2V0U3RvcmVkRG9jc0xpc3RlbmVyKCk7XG4gIH1cblxuICAvLyBMaXN0ZW5lclxuICBAYmluZCAvLyBQZXJtZXQgZGUgbmUgcGFzIHBlcmRyZSBsZSBjb250ZXh0ZSBkZSBsYSBtw6l0aG9kZVxuICBwcml2YXRlIHN1Ym1pdEZvcm1MaXN0ZW5lcigpIHtcbiAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLmhhbmRsZUZvcm1TdWJtaXQpOyAvLyBHcsOiY2UgYXUgZMOpY29yYXRldXIgYmluZCBpbCBuJ2VzdCBwYXMgbsOpY2Vzc2FpcmUgZGUgYmluZCBsYSBtw6l0aG9kZVxuICB9XG4gIHByaXZhdGUgcHJpbnRMaXN0ZW5lcigpIHtcbiAgICB0aGlzLmJ0blByaW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBsZXQgYXZhaWxhYmxlRG9jOiBIYXNQcmludDtcbiAgICAgIGF2YWlsYWJsZURvYyA9IG5ldyBQcmludCh0aGlzLmRvY0NvbnRhaW5lcik7XG4gICAgICBhdmFpbGFibGVEb2MucHJpbnQoKTtcbiAgICB9KTtcbiAgfVxuICBwcml2YXRlIHJlbG9hZExpc3RlbmVyKCkge1xuICAgIHRoaXMuYnRuUmVsb2FkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBkb2N1bWVudC5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICB9KTtcbiAgfVxuICBwcml2YXRlIGdldFN0b3JlZERvY3NMaXN0ZW5lcigpOiB2b2lkIHtcbiAgICAvLyBEYW5zIGNldCBleGVtcGxlLCBsZXMgZm9uY3Rpb25zIGZsw6ljaMOpZXMgKCkgPT4gdGhpcy5nZXRJdGVtcyhcImludm9pY2VcIikgZXQgKCkgPT4gdGhpcy5nZXRJdGVtcyhcImVzdGltYXRlXCIpIGNvbnNlcnZlbnQgbGUgY29udGV4dGUgZGUgdGhpcyBzYW5zIGF2b2lyIGJlc29pbiBkJ3V0aWxpc2VyIGJpbmQoKS5cbiAgICAvLyBDZWxhIGZvbmN0aW9ubmUgcGFyY2UgcXVlIGxlcyBmb25jdGlvbnMgZmzDqWNow6llcyBuJ29udCBwYXMgbGV1ciBwcm9wcmUgY29udGV4dGUgdGhpcywgZWxsZXMgbGUgcHJlbm5lbnQgZGUgbCdlbmNsb3MgZW5nbG9iYW50LlxuICAgIHRoaXMuYnRuU3RvcmVkSW52b2ljZXMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLmdldEl0ZW1zKFwiaW52b2ljZVwiKVxuICAgICk7XG4gICAgdGhpcy5idG5TdG9yZWRFc3RpbWF0ZXMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLmdldEl0ZW1zKFwiZXN0aW1hdGVcIilcbiAgICApO1xuICB9XG5cbiAgLy8gUsOpY3Vww6lyZSBsZXMgZmFjdHVyZS9kZXZpcyBkdSBsb2NhbCBzdG9yYWdlIHBvdXIgbGVzIGFmZmljaGVyXG4gIHByaXZhdGUgZ2V0SXRlbXMoZG9jVHlwZTogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuc3RvcmVkRGF0YURpdi5oYXNDaGlsZE5vZGVzKCkpIHtcbiAgICAgIHRoaXMuc3RvcmVkRGF0YURpdi5pbm5lckhUTUwgPSBcIlwiO1xuICAgIH1cblxuICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShkb2NUeXBlKSkge1xuICAgICAgbGV0IGFycmF5OiBzdHJpbmcgfCBudWxsO1xuICAgICAgYXJyYXkgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShkb2NUeXBlKTtcblxuICAgICAgaWYgKGFycmF5ICE9PSBudWxsICYmIGFycmF5Lmxlbmd0aCA+IDIpIHtcbiAgICAgICAgbGV0IGFycmF5RGF0YTogc3RyaW5nW107XG4gICAgICAgIGFycmF5RGF0YSA9IEpTT04ucGFyc2UoYXJyYXkpO1xuICAgICAgICBhcnJheURhdGEubWFwKChkb2M6IHN0cmluZykgPT4ge1xuICAgICAgICAgIGxldCBjYXJkOiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgbGV0IGNhcmRCb2R5OiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgbGV0IGNhcmRCb2R5Q2xhc3Nlczogc3RyaW5nID0gXCJjYXJkLWJvZHlcIjtcbiAgICAgICAgICBjYXJkLmNsYXNzTGlzdC5hZGQoXCJjYXJkLWNsYXNzZXNcIik7XG4gICAgICAgICAgY2FyZEJvZHkuY2xhc3NMaXN0LmFkZChjYXJkQm9keUNsYXNzZXMpO1xuXG4gICAgICAgICAgY2FyZEJvZHkuaW5uZXJIVE1MID0gZG9jO1xuICAgICAgICAgIGNhcmQuYXBwZW5kKGNhcmRCb2R5KTtcbiAgICAgICAgICB0aGlzLnN0b3JlZERhdGFEaXYuYXBwZW5kKGNhcmQpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3RvcmVkRGF0YURpdi5pbm5lckhUTUwgPSBgPGRpdj5BdWN1biR7XG4gICAgICAgICAgZG9jVHlwZSA9PT0gXCJpbnZvaWNlXCIgPyBcImUgZmFjdHVyZVwiIDogXCIgZGV2aXNcIlxuICAgICAgICB9IGRpc3BvbmlibGUgITwvZGl2PmA7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gSGFuZGxlIEZvcm1cbiAgQGJpbmRcbiAgcHJpdmF0ZSBoYW5kbGVGb3JtU3VibWl0KGU6IEV2ZW50KSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgdGhpcy5oaWRlTGlzdERvY3VtZW50cygpO1xuXG4gICAgY29uc3QgaW5wdXRzID0gdGhpcy5pbnB1dERhdGFzKCk7IC8vIEFycmF5IG91IFVuZGVmaW5lZFxuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXRzKSkge1xuICAgICAgY29uc3QgW1xuICAgICAgICB0eXBlLFxuICAgICAgICBmaXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lLFxuICAgICAgICBhZGRyZXNzLFxuICAgICAgICBjb3VudHJ5LFxuICAgICAgICB0b3duLFxuICAgICAgICB6aXAsXG4gICAgICAgIHByb2R1Y3QsXG4gICAgICAgIHByaWNlLFxuICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgdHZhLFxuICAgICAgXSA9IGlucHV0cztcblxuICAgICAgbGV0IGRvY0RhdGE6IEhhc0h0bWxGb3JtYXQ7XG4gICAgICBsZXQgZGF0ZTogRGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICBkb2NEYXRhID0gbmV3IERhdGFzKC4uLmlucHV0cywgZGF0ZSk7XG5cbiAgICAgIGxldCB0ZW1wbGF0ZTogSGFzUmVuZGVyO1xuICAgICAgdGVtcGxhdGUgPSBuZXcgRGlzcGxheSh0aGlzLmRvY0NvbnRhaW5lciwgdGhpcy5oaWRkZW5EaXYsIHRoaXMuYnRuUHJpbnQpO1xuICAgICAgdGVtcGxhdGUucmVuZGVyKGRvY0RhdGEsIHR5cGUpO1xuICAgIH1cbiAgfVxuICBwcml2YXRlIGhpZGVMaXN0RG9jdW1lbnRzKCkge1xuICAgIHRoaXMuYnRuU3RvcmVkSW52b2ljZXMuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lXCIpO1xuICAgIHRoaXMuYnRuU3RvcmVkRXN0aW1hdGVzLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiZGlzcGxheTogbm9uZVwiKTtcbiAgICB0aGlzLnN0b3JlZERhdGFEaXYuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lXCIpO1xuICB9XG5cbiAgLy8gVHVwbGVcbiAgcHJpdmF0ZSBpbnB1dERhdGFzKCk6XG4gICAgfCBbXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBzdHJpbmcsXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBzdHJpbmcsXG4gICAgICAgIG51bWJlcixcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBudW1iZXIsXG4gICAgICAgIG51bWJlcixcbiAgICAgICAgbnVtYmVyXG4gICAgICBdXG4gICAgfCB2b2lkIHtcbiAgICBjb25zdCB0eXBlID0gdGhpcy50eXBlLnZhbHVlO1xuICAgIGNvbnN0IGZpcnN0TmFtZSA9IHRoaXMuZmlyc3ROYW1lLnZhbHVlO1xuICAgIGNvbnN0IGxhc3ROYW1lID0gdGhpcy5sYXN0TmFtZS52YWx1ZTtcbiAgICBjb25zdCBhZGRyZXNzID0gdGhpcy5hZGRyZXNzLnZhbHVlO1xuICAgIGNvbnN0IGNvdW50cnkgPSB0aGlzLmNvdW50cnkudmFsdWU7XG4gICAgY29uc3QgdG93biA9IHRoaXMudG93bi52YWx1ZTtcbiAgICBjb25zdCB6aXAgPSB0aGlzLnppcC52YWx1ZUFzTnVtYmVyO1xuICAgIGNvbnN0IHByb2R1Y3QgPSB0aGlzLnByb2R1Y3QudmFsdWU7XG4gICAgY29uc3QgcHJpY2UgPSB0aGlzLnByaWNlLnZhbHVlQXNOdW1iZXI7XG4gICAgY29uc3QgcXVhbnRpdHkgPSB0aGlzLnF1YW50aXR5LnZhbHVlQXNOdW1iZXI7XG4gICAgY29uc3QgdHZhID0gdGhpcy50dmEudmFsdWVBc051bWJlcjtcblxuICAgIGlmICh6aXAgPiAwICYmIHByaWNlID4gMCAmJiBxdWFudGl0eSA+IDAgJiYgdHZhID4gMCkge1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgdHlwZSxcbiAgICAgICAgZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZSxcbiAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgY291bnRyeSxcbiAgICAgICAgdG93bixcbiAgICAgICAgemlwLFxuICAgICAgICBwcm9kdWN0LFxuICAgICAgICBwcmljZSxcbiAgICAgICAgcXVhbnRpdHksXG4gICAgICAgIHR2YSxcbiAgICAgIF07XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KFwiTGVzIHZhbGV1cnMgbnVtw6lyaXF1ZXMgZG9pdmVudCDDqnRyZSBzdXDDqXJpZXVyIMOgIHrDqXJvICFcIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBGb3JtSW5wdXQgfSBmcm9tIFwiLi9jbGFzc2VzL0Zvcm1JbnB1dFwiO1xuaW1wb3J0IHsgU3RvcmFnZSB9IGZyb20gXCIuL2NsYXNzZXMvU3RvcmFnZVwiO1xuXG5uZXcgRm9ybUlucHV0KCk7XG5TdG9yYWdlLmNoZWNrTG9jYWxTdG9yYWdlKCk7XG5cbmNvbnNvbGUubG9nKFwiSGVsbG8gV29ybGRcIik7XG4iXSwibmFtZXMiOlsiYmluZCIsInRhcmdldCIsIm1ldGhvZE5hbWUiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJ2YWx1ZSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJ0aGlzIiwiRGF0YXMiLCJjb25zdHJ1Y3RvciIsImRvY3VtZW50VHlwZSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwiYWRkcmVzcyIsImNvdW50cnkiLCJ0b3duIiwiemlwIiwicHJvZHVjdCIsInByaWNlIiwicXVhbnRpdHkiLCJ0dmEiLCJkYXRlIiwic3ViVG90YWwiLCJodG1sRm9ybWF0IiwidG90YWxQcmljZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsInRvRml4ZWQiLCJTdG9yYWdlIiwidHlwZVZhbHVlIiwiaHRtbFN0cmluZyIsIm9sZERhdGEiLCJzZXRJdGVtIiwiY2hlY2tMb2NhbFN0b3JhZ2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiYXJyYXkiLCJKU09OIiwicGFyc2UiLCJwdXNoIiwic3RyaW5naWZ5IiwiZG9jdW1lbnQiLCJsb2NhdGlvbiIsInJlbG9hZCIsIkRpc3BsYXkiLCJjb250YWluZXIiLCJoaWRkZW5EaXYiLCJidG5QcmludCIsImZvcm1Db250YWluZXIiLCJnZXRFbGVtZW50QnlJZCIsInJlbmRlciIsImRvY09iaiIsImRvY1R5cGUiLCJpbm5lckhUTUwiLCJpbm5lclRleHQiLCJzZXRBdHRyaWJ1dGUiLCJQcmludCIsImVsIiwicHJpbnQiLCJib2R5Iiwid2luZG93IiwiRm9ybUlucHV0IiwiZm9ybSIsInR5cGUiLCJkb2NDb250YWluZXIiLCJzdG9yZWREYXRhRGl2IiwiYnRuUmVsb2FkIiwiYnRuU3RvcmVkSW52b2ljZXMiLCJidG5TdG9yZWRFc3RpbWF0ZXMiLCJzdWJtaXRGb3JtTGlzdGVuZXIiLCJwcmludExpc3RlbmVyIiwicmVsb2FkTGlzdGVuZXIiLCJnZXRTdG9yZWREb2NzTGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlRm9ybVN1Ym1pdCIsImF2YWlsYWJsZURvYyIsInNjcm9sbFRvIiwiZ2V0SXRlbXMiLCJoYXNDaGlsZE5vZGVzIiwibGVuZ3RoIiwiYXJyYXlEYXRhIiwibWFwIiwiZG9jIiwiY2FyZCIsImNyZWF0ZUVsZW1lbnQiLCJjYXJkQm9keSIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImhpZGVMaXN0RG9jdW1lbnRzIiwiaW5wdXRzIiwiaW5wdXREYXRhcyIsIkFycmF5IiwiaXNBcnJheSIsImRvY0RhdGEiLCJ0ZW1wbGF0ZSIsIkRhdGUiLCJ2YWx1ZUFzTnVtYmVyIiwiYWxlcnQiLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==